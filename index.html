<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Justin Hilton Photography</title>

<style>
:root {
  --bg: #f7f6f3;
  --text: #222;
  --accent: #111;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: var(--bg);
  color: var(--text);
}

/* NAV */
nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 24px;
  background: #fff;
  border-bottom: 1px solid #ddd;
}
.nav-title {
  font-weight: 600;
  font-size: 18px;
}
.nav-links a {
  margin-left: 16px;
  text-decoration: none;
  color: #333;
  font-weight: 500;
}

/* BANNER */
.banner {
  position: relative;
  width: 100%;
  height: 360px;
  background: url("photos/banner.jpg") center / cover no-repeat;
  display: flex;
  align-items: center;
  justify-content: center;
}
.banner h1 {
  color: white;
  font-size: 42px;
  font-weight: 600;
  letter-spacing: 0.5px;
  text-shadow: 0 4px 18px rgba(0,0,0,.45);
}

/* CONTROLS */
.controls {
  max-width: 1400px;
  margin: 30px auto 10px;
  padding: 0 16px;
}
select {
  padding: 6px 10px;
  font-size: 14px;
}

/* MASONRY */
.gallery {
  column-count: 4;
  column-gap: 14px;
  max-width: 1400px;
  margin: 20px auto 60px;
  padding: 0 16px;
}
@media (max-width: 1200px) { .gallery { column-count: 3; } }
@media (max-width: 800px)  { .gallery { column-count: 2; } }
@media (max-width: 500px)  { .gallery { column-count: 1; } }

.photo {
  break-inside: avoid;
  margin-bottom: 14px;
}
.photo img {
  width: 100%;
  display: block;
  border-radius: 6px;
  cursor: pointer;
}

.like-bar {
  display: flex;
  justify-content: space-between;
  padding: 6px 2px;
  font-size: 14px;
}
.like-btn {
  cursor: pointer;
  user-select: none;
}

/* LIGHTBOX */
.lightbox {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.9);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
.lightbox img {
  max-width: 90%;
  max-height: 80%;
}
.close, .prev, .next {
  position: absolute;
  color: white;
  font-size: 36px;
  cursor: pointer;
}
.close { top: 20px; right: 30px; }
.prev { left: 30px; }
.next { right: 30px; }

.lightbox-like {
  position: absolute;
  bottom: 30px;
  color: white;
  font-size: 18px;
  cursor: pointer;
}

/* FOOTER */
footer {
  text-align: center;
  padding: 40px 10px;
  font-size: 14px;
}
</style>
</head>

<body>

<nav>
  <div class="nav-title">Justin Hilton Photography</div>
  <div class="nav-links">
    <a href="about.html">About</a>
    <a href="game.html">Bobby’s B‑2 Bomber Game</a>
  </div>
</nav>

<div class="banner">
  <h1>Justin Hilton Photography</h1>
</div>

<div class="controls">
  Sort by:
  <select id="sortSelect">
    <option value="default">Default</option>
    <option value="likes">Most Liked</option>
  </select>
</div>

<div id="gallery" class="gallery"></div>

<div id="lightbox" class="lightbox">
  <span class="close">&times;</span>
  <span class="prev">&#10094;</span>
  <img id="lightboxImg">
  <span class="next">&#10095;</span>
  <div id="lightboxLike" class="lightbox-like">♡ Like</div>
</div>

<footer>
  Contact me at
  <a href="mailto:justinhiltonphotography@gmail.com">
    justinhiltonphotography@gmail.com
  </a>
</footer>

<script src="photos.js"></script>

<script>
/* ==========================
   JSONBIN CONFIG — CHANGE THESE
========================== */
const BIN_ID = "https://api.jsonbin.io/v3/b/694d5086ae596e708fb054cd/latest
";
const MASTER_KEY = "$2a$10$FiqRinztCOCKUBEU2aJP8.K6oZqAd7nE3k94Wtb2h0Zc4.kKDprCi";

/* ========================== */

const gallery = document.getElementById("gallery");
const sortSelect = document.getElementById("sortSelect");

let currentIndex = 0;
let photos = [];
let likesData = {};
const userLikes = JSON.parse(localStorage.getItem("userLikes") || "{}");

async function loadLikes() {
  const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
    headers: { "X-Master-Key": MASTER_KEY }
  });
  const json = await res.json();
  likesData = json.record || {};
}

async function saveLikes() {
  await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
    method: "PUT",
    headers: {
      "Content-Type": "application/json",
      "X-Master-Key": MASTER_KEY
    },
    body: JSON.stringify(likesData)
  });
}

function buildPhotos() {
  photos = PHOTOS.map(src => ({
    src,
    likes: likesData[src] || 0,
    liked: userLikes[src] === true
  }));
}

function render() {
  gallery.innerHTML = "";
  photos.forEach((p, i) => {
    const div = document.createElement("div");
    div.className = "photo";

    const img = document.createElement("img");
    img.src = p.src;
    img.onclick = () => openLightbox(i);

    const bar = document.createElement("div");
    bar.className = "like-bar";

    const btn = document.createElement("span");
    btn.className = "like-btn";
    btn.textContent = p.liked ? "❤️" : "♡";
    btn.onclick = () => toggleLike(i);

    const count = document.createElement("span");
    count.textContent = p.likes + " likes";

    bar.append(btn, count);
    div.append(img, bar);
    gallery.appendChild(div);
  });
}

async function toggleLike(i) {
  const p = photos[i];
  p.liked = !p.liked;
  p.likes += p.liked ? 1 : -1;

  likesData[p.src] = p.likes;
  userLikes[p.src] = p.liked;
  localStorage.setItem("userLikes", JSON.stringify(userLikes));

  await saveLikes();
  render();
  updateLightbox();
}

sortSelect.onchange = () => {
  if (sortSelect.value === "likes") {
    photos.sort((a, b) => b.likes - a.likes);
  } else {
    buildPhotos();
  }
  render();
};

/* LIGHTBOX */
const lightbox = document.getElementById("lightbox");
const lightboxImg = document.getElementById("lightboxImg");
const lightboxLike = document.getElementById("lightboxLike");

function openLightbox(i) {
  currentIndex = i;
  updateLightbox();
  lightbox.style.display = "flex";
}
function updateLightbox() {
  const p = photos[currentIndex];
  lightboxImg.src = p.src;
  lightboxLike.textContent = (p.liked ? "❤️ " : "♡ ") + p.likes + " likes";
}
document.querySelector(".close").onclick = () => lightbox.style.display = "none";
document.querySelector(".prev").onclick = () => {
  currentIndex = (currentIndex - 1 + photos.length) % photos.length;
  updateLightbox();
};
document.querySelector(".next").onclick = () => {
  currentIndex = (currentIndex + 1) % photos.length;
  updateLightbox();
};
lightboxLike.onclick = () => toggleLike(currentIndex);

/* INIT */
(async () => {
  await loadLikes();
  buildPhotos();
  render();
})();
</script>

</body>
</html>
